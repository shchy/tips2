machine:
    timezone:
        Asia/Tokyo
    services:
        - docker

dependencies:
    cache_directories:
        - "~/cache"
    pre:
        - docker build --build-arg tag=$CIRCLE_TAG -t shch/tips:$CIRCLE_TAG .

test:
    override:
        - docker run shch/tips:CIRCLE_TAG dnx -p test/TipsWeb.test/project.json test -parallel none

deployment:
    hub:
        branch: master
        commands:
            - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
            - docker push shch/tips:CIRCLE_TAG
